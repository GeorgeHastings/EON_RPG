{"version":3,"sources":["../utils.js","../gamestate.js","../player.js","../ui.js","../combat.js","../effects.js","../items.js","../enemies.js","../moments.js","../app.js"],"names":["colorize","str","color","roll","min","max","Math","floor","random","getObj","arr","val","result","filter","o","name","getFromArr","slot","removeFromArr","index","indexOf","splice","getObjLvl","i","length","level","push","forEach","fn","forEachMethod","bindToMany","elements","eventType","els","document","querySelectorAll","getName","obj","map","element","getRandomLootByLevel","type","itemsOfLevel","Items","colorHealth","percentage","green","red","r","g","b","toFixed","newTextElement","tag","text","wrap","createElement","content","createTextNode","appendChild","currentMoment","this","moment","UI","narrative","renderMoment","checkForAndCreateChoices","checkForAndPickUpLoot","checkForAndRunCombat","checkForAndOpenUpShop","checkForAndRunInn","checkForAndRunOnLoad","scrollToBottom","el","hasOwnProperty","onLoad","item","loot","_typeof","all","lootIsDiscovered","Player","pickUpLoot","Combat","runCombat","renderShop","bindShopItemEvents","bindWorldItemEvents","innExists","price","inn","gold","updateGold","healthTotal","healthMax","updateStats","combatLog","renderCombatLog","colors","player","choicesExist","renderChoices","intventoryItems","inventory","onclick","activateItem","shopItems","inventoryItems","purchaseItem","j","sellItem","gainLvl","armor","toughness","quickness","equippedWeapon","equippedArmor","head","chest","back","belt","pants","boots","experience","GameState","messages","nextLevelExp","exp","setHealth","setDamage","setArmor","setToughness","setDamageReduction","setQuicknessProc","statlist","renderStats","amt","renderGold","health","combat","updateHealthBar","armorAmt","damage","damageReduction","quicknessProc","damageDealt","round","getBaseDamage","target","procExists","procFires","procHit","hitType","hitColor","criticallyHit","rollQuicknessProc","targetDodged","hitMessage","effects","effect","constructor","run","proc","attackerName","rarity","entity","multiplier","Enemies","enemy","items","dropLoot","processRandomLoot","addToInventory","renderLootMessage","renderInventoryItem","removeInventoryItem","unequipCurrentWeapon","itemInSlotExists","unequipArmor","isStatbuff","remove","wep","removeWepBuff","itemId","getAttribute","NewPlayerHasEnoughGold","getPurchasePrice","renderItemTransaction","renderCannotPurchaseMessage","getSalePrice","removeFromInventory","itemDescription","hideItemDescription","none","common","rare","epic","legendary","set","getElementById","num","setCurrentMoment","Moments","itemEl","itemText","setAttribute","bindEvents","shopList","shop","renderShopItem","choiceEl","choiceText","choice","message","link","getMomentByClick","choices","renderChoice","innerHTML","messageWrapper","messageText","thisStat","stat","parentNode","stats","renderStat","itemWrapper","momentIsShop","armorIsEquipped","itemType","isEquippedWep","renderEquippedWeapon","classList","add","currentWep","querySelector","allArmors","removeEquippedWepTag","removeEquippedArmorTag","thisItemId","isUnequipped","equipWeapon","use","equipArmor","renderEquippedArmor","initialX","initialY","yPos","event","pageY","intialY","xPos","pageX","intialX","d","winWidth","window","innerWidth","winHeight","innerHeight","x","getInitialX","y","getInitialY","translation","offsetWidth","style","left","offsetHeight","top","webkitTransform","transform","display","textNode","className","property","prop","createEl","description","buyItem","showItemDescription","calcNexLevelExp","avg","weightedAvg","hasProcEffect","chance","thisStatId","statDesc","getStatDescriptions","onmouseenter","renderItemDescription","onmousemove","position","onmouseleave","renderStatDescription","logitemWrapper","logitem","transaction","multipleLoots","oneLoot","defeatedEnemy","foundLoot","conj","renderHealthBar","healthBar","pct","adjustedPct","background","pane","scrollTop","scrollHeight","fighting","rounds","generateEnemy","enemyType","buildNormalEnemy","buildCustomEnemy","playerWins","pickUpGold","awardExperience","playerLoses","playerLost","updateExperience","hasEnoughExp","levelUp","fight","count","attacker","defender","attack","thisCombat","setInterval","clearInterval","buffs","statBuff","Effects","weaponDamage","minMax","logMessage","debuffs","heals","heal","healPlayer","quest","procs","itemProc","wd","procChance","mirrorDamage","e","amount","lostHealth","weapons","consumables","rarities","types","weapon","consumable","flavorText","desc","Pricing","getRarityMultiplier","Item","Enemy","prototype","CustomEnemy","call","allEnemies","enemies","concat","customEnemies","apply","moment0","reset","moment1","moment2","moment3","moment4","equipping","init","moment5","moment6","moment8","moment9","moment10","healing","moment12","moment13","moment13a","moment14","moment15","moment16","moment17","moment17b","moment17c","moment18","moment19","moment20","moment21","moment22","moment23","moment24","moment26","moment27","moment28","bindStatEvents","title","advance","button"],"mappings":"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","file":"app-min.js","sourcesContent":["var colorize = function(str, color) {\n  return '<span style=\"color: '+color+';\">'+str+'</span>';\n};\n\nvar roll = function(min, max) {\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n};\n\n\nvar getObj = function(arr, val) {\n  var result = arr.filter(function(o) {\n    return o.name === val;\n  });\n  return result ? result[0] : null;\n};\n\nvar getFromArr = function(arr, val) {\n  var result = arr.filter(function(o) {\n    return o.slot === val;\n  });\n  return result ? result[0] : null;\n};\n\nvar removeFromArr = function(arr, val) {\n  var index = arr.indexOf(val);\n  if (index > -1) {\n    arr.splice(index, 1);\n  }\n};\n\nvar getObjLvl = function(arr, val) {\n  var result = [];\n  for (var i = 0; i < arr.length; i++) {\n    if (arr[i].level === val) {\n      result.push(arr[i]);\n    }\n  }\n  return result;\n};\n\nvar forEach = function(arr, fn) {\n  for (var i = 0; i < arr.length; i++) {\n    fn(arr[i]);\n  }\n};\n\nvar forEachMethod = function(arr, fn) {\n  for (var i = 0; i < arr.length; i++) {\n    arr[i][fn]();\n  }\n};\n\nvar bindToMany = function(elements, eventType, fn) {\n  var els = document.querySelectorAll(elements);\n  for(var i = 0; i < els.length; i++) {\n    els[i][eventType] = fn;\n  }\n};\n\nvar getName = function(obj) {\n  return obj.name;\n};\n\nvar map = function(arr, fn) {\n  var result = [];\n  forEach(arr, function (element) {\n    result.push(fn(element));\n  });\n  return result;\n};\n\nvar getRandomLootByLevel = function(type, level) {\n  var itemsOfLevel = getObjLvl(Items[type], level);\n  return itemsOfLevel[roll(0, itemsOfLevel.length - 1)];\n};\n\nvar colorHealth = function(percentage) {\n  var green = [36, 251, 39];\n  var red = [255, 104, 57];\n  var r = green[0],\n      g = green[1],\n      b = green[2];\n  r = r + (red[0] - green[0])*(1 - percentage);\n  g = g - (green[1] - red[1])*(1 - percentage);\n  b = b + (red[2] - green[2])*(1 - percentage);\n  return 'rgb('+r.toFixed(0)+', '+g.toFixed(0)+', '+b.toFixed(0)+')';\n};\n\nvar newTextElement = function(tag, text) {\n  var wrap = document.createElement(tag);\n  var content = document.createTextNode(text);\n  wrap.appendChild(content);\n  return wrap;\n};\n","'use strict';\n\nvar GameState = {\n  currentMoment: '',\n\n  setCurrentMoment: function(moment) {\n    this.currentMoment = moment;\n    UI.narrative.renderMoment();\n    this.checkForAndCreateChoices();\n    this.checkForAndPickUpLoot();\n    this.checkForAndRunCombat();\n    this.checkForAndOpenUpShop();\n    this.checkForAndRunInn();\n    this.checkForAndRunOnLoad();\n    UI.scrollToBottom(UI.narrative.el);\n  },\n\n  checkForAndRunOnLoad: function() {\n    if (this.currentMoment.hasOwnProperty('onLoad')) {\n      this.currentMoment.onLoad();\n    }\n  },\n\n  processRandomLoot: function(loot) {\n    var item;\n    if(typeof loot === 'object') {\n      item = getRandomLootByLevel(loot[0], loot[1]);\n    }\n    else {\n      item = getObj(Items.all, loot);\n    }\n    return item;\n  },\n\n  checkForAndPickUpLoot: function() {\n    var lootIsDiscovered = this.currentMoment.hasOwnProperty('dropLoot') && !this.currentMoment.hasOwnProperty('enemy');\n    if (lootIsDiscovered) {\n      Player.pickUpLoot();\n    }\n  },\n\n  checkForAndRunCombat: function() {\n    if (this.currentMoment.hasOwnProperty('enemy')) {\n      Combat.runCombat();\n    }\n  },\n\n  checkForAndOpenUpShop: function() {\n    if (this.currentMoment.hasOwnProperty('shop')) {\n      UI.narrative.renderShop();\n      this.bindShopItemEvents();\n    } else {\n      this.bindWorldItemEvents();\n    }\n  },\n\n  checkForAndRunInn: function() {\n    var innExists = this.currentMoment.hasOwnProperty('inn');\n    if (innExists) {\n      var price = this.currentMoment.inn;\n      if (Player.gold >= price) {\n        Player.updateGold(-price);\n        Player.healthTotal = Player.healthMax;\n        Player.updateStats();\n        UI.combatLog.renderCombatLog(colorize('You', UI.colors.player)+ ' bought a room for '+colorize(price + ' gold', UI.colors.gold)+'.');\n        UI.combatLog.renderCombatLog(colorize('Your', UI.colors.player) + ' health is '+colorize('fully restored', UI.colors.green));\n      } else {\n        UI.combatLog.renderCombatLog(colorize('You', UI.colors.player)+ ' need '+colorize(price - Player.gold, UI.colors.gold)+' to get a room.');\n      }\n    }\n  },\n\n  checkForAndCreateChoices: function() {\n    var choicesExist = this.currentMoment.hasOwnProperty('choices');\n    if (choicesExist) {\n      UI.narrative.renderChoices();\n    }\n  },\n\n  bindWorldItemEvents: function() {\n    var intventoryItems = UI.inventory.el.querySelectorAll('[data-item]');\n    for (var i = 0; i < intventoryItems.length; i++) {\n      intventoryItems[i].onclick = UI.inventory.activateItem;\n    }\n  },\n\n  bindShopItemEvents: function() {\n    var shopItems = UI.narrative.el.querySelectorAll('[data-item]');\n    var inventoryItems = UI.inventory.el.querySelectorAll('[data-item]');\n    for (var i = 0; i < shopItems.length; i++) {\n      shopItems[i].onclick = Player.purchaseItem;\n    }\n    for (var j = 0; j < inventoryItems.length; j++) {\n      inventoryItems[j].onclick = Player.sellItem;\n    }\n  },\n\n  messages: {\n    gainLvl: colorize('You gained a level! Your toughness and quickness have increased by 1.', 'yellow')\n  }\n};\n","'use strict';\n\nvar Player = {\n  name: 'You',\n  level: 1,\n  healthMax: 25,\n  healthTotal: 25,\n  armor: 0,\n  toughness: 0,\n  quickness: 1,\n  equippedWeapon: '',\n  equippedArmor: {\n    head: '',\n    chest: '',\n    back: '',\n    belt: '',\n    pants: '',\n    boots: ''\n  },\n  inventory: [],\n  gold: 0,\n  experience: 0,\n\n  levelUp: function() {\n    this.level = this.level + 1;\n    this.toughness = this.toughness + 1;\n    this.quickness = this.quickness + 1;\n    this.healthTotal = this.healthMax;\n    this.updateStats();\n    UI.combatLog.renderCombatLog(GameState.messages.gainLvl);\n  },\n\n  calcNexLevelExp: function() {\n    var nextLevelExp = 80;\n    for(var i = 0; i < this.level; i++) {\n      nextLevelExp = nextLevelExp + (i+1)*20;\n    }\n    return nextLevelExp;\n  },\n\n  updateExperience: function(exp) {\n    this.experience = this.experience + exp;\n    UI.combatLog.renderCombatLog(colorize('You', '#fff')+' gained '+colorize(exp +' experience.', '#fff'));\n  },\n\n  updateStats: function() {\n    this.setHealth();\n    this.setDamage();\n    this.setArmor();\n    this.setToughness();\n    this.setDamageReduction();\n    this.setQuicknessProc();\n    UI.statlist.renderStats();\n  },\n\n  updateGold: function(amt) {\n    this.gold += amt;\n    UI.inventory.renderGold();\n  },\n\n  setHealth: function() {\n    this.health = '' + this.healthTotal + '/' + this.healthMax + '';\n    UI.combat.updateHealthBar();\n  },\n\n  setArmor: function() {\n    this.armor = 0;\n    for (var item in this.equippedArmor) {\n      if(this.equippedArmor[item].armorAmt) {\n        this.armor += this.equippedArmor[item].armorAmt;\n      }\n    }\n    this.armor += this.toughness;\n  },\n\n  setDamage: function() {\n    if (this.equippedWeapon) {\n      this.damage = '' + this.equippedWeapon.damage[0] + '-' + this.equippedWeapon.damage[1] + '';\n    } else {\n      this.damage = '0-2';\n    }\n  },\n\n  setDamageReduction: function() {\n    this.damageReduction = (1 - (0.03 * this.armor) / (1 + 0.03 * this.armor)).toFixed(2);\n  },\n\n  setToughness: function() {\n    this.healthMax = 25 + this.toughness;\n  },\n\n  setQuicknessProc: function() {\n    this.quicknessProc = ((0.02 * this.quickness) / ((1 + 0.02 * this.quickness)) * 100).toFixed(2);\n  },\n\n  getBaseDamage: function() {\n    return this.equippedWeapon ? roll(this.equippedWeapon.damage[0],this.equippedWeapon.damage[1]) : roll(0,3);\n  },\n\n  rollQuicknessProc: function() {\n  \treturn roll(0, 100) <= this.quicknessProc ? true : false;\n  },\n\n  attack: function(target) {\n    var damageDealt = Math.round(this.getBaseDamage() * target.damageReduction);\n    var procExists;\n    var procFires;\n    var procHit = '';\n    var hitType = 'hit';\n    var hitColor = 'yellow';\n    var criticallyHit = this.rollQuicknessProc();\n    var targetDodged = target.rollQuicknessProc();\n    var hitMessage;\n\n    if(this.equippedWeapon.effect) {\n      var effects = this.equippedWeapon.effect;\n      procExists = effects[effects.length - 1].constructor.name === 'itemProc';\n      procFires = effects[effects.length - 1].run();\n    }\n    if (criticallyHit) {\n      damageDealt = damageDealt * 2;\n      hitType = ''+colorize('critically hit', UI.colors.red)+'';\n      hitColor = UI.colors.red;\n    }\n    if (procExists && procFires) {\n      var proc = effects[effects.length - 1];\n      var attackerName;\n      if(this.name === 'You') {attackerName = 'Your';}\n      else {attackerName = this.name + '\\'s';}\n      target.healthTotal -= proc.amt;\n      procHit = ' and '+colorize(this.equippedWeapon.name, UI.colors[this.equippedWeapon.rarity])+' hits for '+colorize(proc.amt, 'yellow');\n    }\n    if (targetDodged) {\n      UI.combatLog.renderCombatLog(colorize(target.healthTotal, colorHealth(target.healthTotal/target.healthMax)) + ' ' + colorize(target.name, UI.colors.entity) + ' '+colorize('dodged', 'yellow')+' ' + colorize(this.name, UI.colors.entity) + ' for 0');\n    } else {\n      target.healthTotal -= damageDealt;\n      hitMessage = colorize(this.healthTotal, colorHealth(this.healthTotal/this.healthMax)) + ' ' + colorize(this.name, UI.colors.entity) + ' ' + hitType + ' ' + colorize(target.name, UI.colors.entity) + ' for '+colorize(damageDealt, hitColor);\n      UI.combatLog.renderCombatLog(hitMessage + procHit);\n    }\n    Player.updateStats();\n  },\n\n  pickUpGold: function() {\n    var multiplier = getObj(Enemies, GameState.currentMoment.enemy).level;\n    var gold = roll(4, 8) * multiplier;\n    Player.updateGold(gold);\n    UI.combatLog.renderCombatLog(''+colorize('You', UI.colors.player)+' found ' + colorize(gold + ' gold.', UI.colors.gold));\n  },\n\n  pickUpLoot: function() {\n    var items = map(GameState.currentMoment.dropLoot, GameState.processRandomLoot);\n    forEach(items, Player.addToInventory);\n    UI.combatLog.renderLootMessage(items);\n  },\n\n  addToInventory: function(item) {\n    Player.inventory.push(item);\n    UI.inventory.renderInventoryItem(item);\n  },\n\n  removeFromInventory: function(item, element) {\n    removeFromArr(this.inventory, item);\n    UI.inventory.removeInventoryItem(element);\n  },\n\n  equipWeapon: function(item) {\n    if(this.equippedWeapon){\n      this.unequipCurrentWeapon();\n    }\n    this.equippedWeapon = item;\n    this.updateStats();\n  },\n\n  equipArmor: function(item) {\n    var itemInSlotExists = this.equippedArmor[item.slot];\n    if(itemInSlotExists) {\n      Player.unequipArmor(this.equippedArmor[item.slot]);\n    }\n    this.equippedArmor[item.slot] = item;\n    this.updateStats();\n  },\n\n  unequipArmor: function(armor) {\n    this.equippedArmor[armor.slot] = '';\n    if(armor.effect) {\n      forEachMethod(armor.effect, 'remove');\n    }\n  },\n\n  removeWepBuff: function(effect) {\n    var isStatbuff = effect.constructor.name === 'statBuff';\n    if (isStatbuff === true) {\n      effect.remove();\n    }\n  },\n\n  unequipCurrentWeapon: function() {\n    var wep = this.equippedWeapon;\n    if(wep.effect) {\n      forEach(wep.effect, this.removeWepBuff);\n    }\n    if (wep) {\n      wep = '';\n    }\n  },\n\n  purchaseItem: function() {\n    var itemId = this.getAttribute('data-item');\n    var item = getObj(Items.all, itemId);\n    var NewPlayerHasEnoughGold = Player.gold >= item.getPurchasePrice();\n    if (NewPlayerHasEnoughGold) {\n      Player.updateGold(-item.getPurchasePrice());\n      Player.addToInventory(item);\n      UI.combatLog.renderItemTransaction(colorize(item.name, UI.colors[item.rarity]), item.getPurchasePrice(), 'bought');\n    } else {\n      UI.combatLog.renderCannotPurchaseMessage(colorize(item.name, UI.colors[item.rarity]), item.getPurchasePrice());\n    }\n  },\n\n  sellItem: function() {\n    var itemId = this.getAttribute('data-item');\n    var item = getObj(Items.all, itemId);\n    Player.updateGold(item.getSalePrice());\n\n    if (item === Player.equippedWeapon) {\n      Player.unequipCurrentWeapon();\n    }\n    if (item === Player.equippedArmor[item.slot]) {\n      Player.unequipArmor(item);\n    }\n    Player.removeFromInventory(item, this);\n    Player.updateStats();\n    UI.itemDescription.hideItemDescription();\n    UI.combatLog.renderItemTransaction(colorize(item.name, UI.colors[item.rarity]), item.getSalePrice(), 'sold');\n  },\n\n  reset: function() {\n    this.name = 'You';\n    this.level = 1;\n    this.healthMax = 25;\n    this.healthTotal = 25;\n    this.armor = 0;\n    this.toughness = 0;\n    this.quickness = 1;\n    this.equippedWeapon = '';\n    this.equippedArmor = {\n      head: '',\n      chest: '',\n      back: '',\n      belt: '',\n      pants: '',\n      boots: ''\n    };\n    this.inventory = [];\n    this.gold = 0;\n    this.experience = 0;\n    Player.updateStats();\n    Player.updateGold(0);\n  }\n};\n","'use strict';\n\n// requirejs(['player'], function(player){\n//   var Player = Player;\n// });\n\nvar UI = {\n  colors: {\n    none: '#939DBD',\n    common: '#fff',\n    rare: '#0047FF',\n    epic: '#9E65C4',\n    legendary: '#C6AF66',\n    set: '#32cbb4',\n    entity: '#fff',\n    player: '#fff',\n    enemy: '#fff',\n    gold: '#E5CA48',\n    red: '#ff6839',\n    green: '#23fa88'\n  },\n\n  narrative: {\n    el: document.getElementById('narrative'),\n\n    getMomentByClick: function() {\n      var num = this.getAttribute('data-moment');\n      GameState.setCurrentMoment(Moments['moment' + num + '']);\n    },\n\n    renderShopItem: function(item) {\n      var itemEl = document.createElement('a');\n      var itemText = document.createTextNode(item.name);\n      itemEl.setAttribute('data-item', item.name);\n      UI.itemDescription.bindEvents(itemEl);\n      itemEl.appendChild(itemText);\n      UI.narrative.el.appendChild(itemEl);\n      itemEl.onclick = Player.purchaseItem;\n    },\n\n    renderShop: function() {\n      var shopList = map(GameState.currentMoment.shop, GameState.processRandomLoot);\n      forEach(shopList, UI.narrative.renderShopItem);\n      bindToMany('#inventory [data-item]', 'onclick', Player.sellItem);\n    },\n\n    renderChoice: function(choice) {\n      var choiceEl = document.createElement('a');\n      var choiceText = document.createTextNode(choice.message);\n      choiceEl.setAttribute('data-moment', choice.link);\n      choiceEl.appendChild(choiceText);\n      choiceEl.onclick = UI.narrative.getMomentByClick;\n      UI.narrative.el.appendChild(choiceEl);\n    },\n\n    renderChoices: function() {\n      var choices = GameState.currentMoment.choices;\n      forEach(choices, UI.narrative.renderChoice);\n    },\n\n    renderMoment: function() {\n      UI.narrative.el.innerHTML = '';\n      var messageWrapper = document.createElement('p');\n      var messageText = document.createTextNode(GameState.currentMoment.message);\n      messageWrapper.appendChild(messageText);\n      UI.narrative.el.appendChild(messageWrapper);\n    }\n  },\n\n  statlist: {\n    el: document.getElementById('stat-list'),\n\n    renderStat: function(stat) {\n      var thisStat = stat.parentNode.getAttribute('data-stat');\n      stat.innerHTML = Player[thisStat];\n    },\n\n    renderStats: function() {\n      var stats = this.el.querySelectorAll('div');\n      forEach(stats, this.renderStat);\n    }\n  },\n\n  inventory: {\n    el: document.getElementById('inventory'),\n    gold: document.getElementById('gold'),\n\n    renderInventoryItem: function(item) {\n      var itemWrapper = document.createElement('li');\n      var itemText = document.createTextNode(item.name);\n      var momentIsShop = GameState.currentMoment.hasOwnProperty('shop');\n      var armorIsEquipped = item.itemType === 'armor' && item === Player.equippedArmor[item.slot];\n      var isEquippedWep = Player.equippedWeapon && item === Player.equippedWeapon;\n      itemWrapper.appendChild(itemText);\n      itemWrapper.setAttribute('data-item', item.name);\n      UI.itemDescription.bindEvents(itemWrapper);\n      UI.inventory.el.appendChild(itemWrapper);\n\n      if (momentIsShop) {\n        GameState.bindShopItemEvents();\n      } else {\n        GameState.bindWorldItemEvents();\n      }\n\n      if (isEquippedWep) {\n        UI.inventory.renderEquippedWeapon(itemWrapper);\n      }\n\n      if(armorIsEquipped) {\n        itemWrapper.classList.add('equipped-armor');\n      }\n    },\n\n    removeInventoryItem: function(element) {\n      element.remove();\n    },\n\n    renderInventory: function() {\n      this.el.innerHTML = '';\n      forEach(Player.inventory, this.renderInventoryItem);\n    },\n\n    renderGold: function() {\n      UI.inventory.gold.innerHTML = Player.gold;\n    },\n\n    removeEquippedWepTag: function() {\n      var currentWep = document.querySelector('.equipped-wep');\n      if (currentWep) {\n        currentWep.classList.remove('equipped-wep');\n      }\n    },\n\n    removeEquippedArmorTag: function() {\n      var allArmors = document.querySelectorAll('.equipped-armor');\n      for (var i = 0; i < allArmors.length; i++) {\n        allArmors[i].classList.remove('equipped-armor');\n      }\n    },\n\n    renderEquippedWeapon: function(itemWrapper) {\n      this.removeEquippedWepTag();\n      itemWrapper.classList.add('equipped-wep');\n    },\n\n    renderEquippedArmor: function() {\n      this.removeEquippedArmorTag();\n      for (var armor in Player.equippedArmor) {\n        if(Player.equippedArmor[armor].name) {\n          UI.inventory.el.querySelector('[data-item=\"' + Player.equippedArmor[armor].name + '\"').classList.add('equipped-armor');\n        }\n      }\n    },\n\n    activateItem: function() {\n      var thisItemId = this.getAttribute('data-item');\n      var item = getObj(Items.all, thisItemId);\n      var isUnequipped = Player.equippedWeapon !== item && item !== Player.equippedArmor[item.slot];\n\n      if(isUnequipped) {\n        if(item.itemType === 'weapon') {\n          Player.equipWeapon(item);\n          UI.inventory.renderEquippedWeapon(this);\n          item.use();\n        }\n        else if(item.itemType === 'armor') {\n          Player.equipArmor(item);\n          UI.inventory.renderEquippedArmor();\n          item.use();\n        }\n      }\n\n      if (item.itemType === 'consumable') {\n        Player.removeFromInventory(item, this);\n        UI.itemDescription.hideItemDescription();\n        item.use();\n      }\n      if(item.itemType === 'quest') {\n        item.use();\n      }\n    },\n  },\n\n  itemDescription: {\n    el: document.getElementById('itemDescription'),\n    items: document.getElementById('descItems'),\n    initialX: 0,\n    initialY: 0,\n\n    getInitialY: function(event) {\n      var yPos = event.pageY;\n      UI.itemDescription.intialY = yPos;\n      return yPos;\n\n    },\n\n    getInitialX: function(event) {\n      var xPos = event.pageX;\n      UI.itemDescription.intialX = xPos;\n      return xPos;\n    },\n\n    position: function(event) {\n      var d = UI.itemDescription;\n      var winWidth = window.innerWidth;\n      var winHeight = window.innerHeight;\n      var x = d.getInitialX(event);\n      var y = d.getInitialY(event);\n      var translation = 'translate3d('+x+'px,'+y+'px, 0)';\n      if(event.pageX + (d.el.offsetWidth + 10) > winWidth) {\n        d.el.style.left = (d.initialX - d.el.offsetWidth - 10) + 'px';\n      }\n      else {\n        d.el.style.left = d.initialX + 10 + 'px';\n      }\n      if(event.pageY + (d.el.offsetHeight + 10) > winHeight) {\n        d.el.style.top = (d.initialY - d.el.offsetHeight - 10) + 'px';\n      }\n      else {\n        UI.itemDescription.el.style.top = d.initialY + 10 + 'px';\n      }\n      d.el.style.webkitTransform = translation;\n      d.el.style.transform = translation;\n    },\n\n    showItemDescription: function() {\n      UI.itemDescription.el.style.display = 'block';\n    },\n\n    hideItemDescription: function() {\n      UI.itemDescription.el.style.display = 'none';\n    },\n\n    createEl: function(text, className) {\n      var el = document.createElement('div');\n      var textNode = document.createTextNode(text);\n      el.classList.add(className);\n      el.appendChild(textNode);\n      return el;\n    },\n\n    renderItemDescription: function() {\n      UI.itemDescription.items.innerHTML = '';\n      var thisItemId = this.getAttribute('data-item');\n      var item = getObj(Items.all, thisItemId);\n      var property;\n\n      for (var prop in item) {\n        if (typeof item[prop] !== 'function') {\n          if(prop === 'damage') {\n            property = UI.itemDescription.createEl(item[prop][0]+'-'+item[prop][1], ''+prop+'');\n          }\n          else {\n            property = UI.itemDescription.createEl(item[prop], ''+prop+'');\n          }\n          if (prop === 'effect'){\n            property = UI.itemDescription.createEl(item[prop].description, ''+prop+'');\n            for(var i = 0; i < item.effect.length; i++ ) {\n              property = UI.itemDescription.createEl(item[prop][i].description, ''+prop+'');\n              UI.itemDescription.items.appendChild(property);\n            }\n          }\n          if(prop === 'rarity') {\n            document.querySelector('.name').style.color = UI.colors[item[prop]];\n          }\n          if(prop === 'flavorText' && item[prop] === '') {\n\n          }\n          else {\n            UI.itemDescription.items.appendChild(property);\n          }\n        }\n        else if (prop === 'getSalePrice' && this.parentNode === UI.inventory.el){\n          property = UI.itemDescription.createEl(item[prop](), ''+prop+'');\n          UI.itemDescription.items.appendChild(property);\n          if(GameState.currentMoment.hasOwnProperty('shop')) {\n            var sellItem = UI.itemDescription.createEl('(Click to sell)', 'shop-item');\n            UI.itemDescription.items.appendChild(sellItem);\n          }\n        }\n        else if (prop === 'getPurchasePrice' && this.parentNode === UI.narrative.el){\n          property = UI.itemDescription.createEl(item[prop](), ''+prop+'');\n          UI.itemDescription.items.appendChild(property);\n          if(GameState.currentMoment.hasOwnProperty('shop')) {\n            var buyItem = UI.itemDescription.createEl('(Click to buy)', 'shop-item');\n            UI.itemDescription.items.appendChild(buyItem);\n          }\n        }\n      }\n      UI.itemDescription.showItemDescription();\n    },\n\n    getStatDescriptions: {\n      wep: Player.equippedWeapon,\n      level: function() {\n        return 'You have '+Player.experience+' points. You need '+(Player.calcNexLevelExp() - Player.experience)+' to reach the next level.';\n      },\n      health: function() {\n        return 'You have '+(Player.healthTotal/Player.healthMax*100).toFixed(0)+'% health';\n      },\n      armor: function() {\n        return 'Reduces damage taken to ' + (Player.damageReduction * 100).toFixed(2) + '%';\n      },\n      quickness: function() {\n        return '' + Player.quicknessProc + '% chance to critical hit and dodge';\n      },\n      damage: function() {\n        var avg;\n        var wep = Player.equippedWeapon;\n        if(wep) {\n          avg = (wep.damage[0] + wep.damage[1]) / 2;\n        }\n        else {\n          avg = 1;\n        }\n        var weightedAvg = (avg + (Player.quicknessProc / 100 * avg));\n        var hasProcEffect = wep.effect && wep.effect.constructor.name === 'ItemProc';\n        if(hasProcEffect) {\n          var chance = wep.effect.chance / 100;\n          var amt = wep.effect.amt;\n          weightedAvg = (weightedAvg + chance * amt);\n        }\n        return '' + weightedAvg.toFixed(2) + ' average total damage per hit';\n      },\n      toughness: function() {\n        return 'Increases armor and max health by ' + Player.toughness + '';\n      }\n    },\n\n    renderStatDescription: function() {\n      var thisStatId = this.getAttribute('data-stat');\n      var statDesc = UI.itemDescription.getStatDescriptions[thisStatId]();\n      var property = UI.itemDescription.createEl(statDesc, 'stat');\n      property.classList.add('property-label');\n      UI.itemDescription.items.innerHTML = '';\n      UI.itemDescription.items.innerHTML = colorize(thisStatId, UI.colors.green);\n      UI.itemDescription.items.appendChild(property);\n      UI.itemDescription.showItemDescription();\n    },\n\n    bindEvents: function(element) {\n      element.onmouseenter = UI.itemDescription.renderItemDescription;\n      element.onmousemove = UI.itemDescription.position;\n      element.onmouseleave = UI.itemDescription.hideItemDescription;\n    },\n\n    bindStatEvents: function() {\n      bindToMany('[data-stat]', 'onmouseenter', this.renderStatDescription);\n      bindToMany('[data-stat]', 'onmousemove', this.position);\n      bindToMany('[data-stat]', 'onmouseleave', this.hideItemDescription);\n    },\n  },\n\n  combatLog: {\n    el: document.getElementById('combatLog'),\n\n    renderCombatLog: function(logitem) {\n      var logitemWrapper = document.createElement('p');\n      logitemWrapper.innerHTML = (logitem);\n      this.el.appendChild(logitemWrapper);\n      UI.scrollToBottom(document.querySelector('.combat-log-container'));\n    },\n\n    renderItemTransaction: function(name, price, transaction) {\n      this.renderCombatLog(colorize('You', UI.colors.player) +' '+ transaction+' ' + name + ' for ' + colorize(price + ' gold', UI.colors.gold)+'.');\n    },\n\n    renderCannotPurchaseMessage: function(name, price) {\n      this.renderCombatLog(colorize('You', UI.colors.player) + ' need ' + colorize(price - Player.gold + ' gold', UI.colors.gold) + ' to buy ' + name + '.');\n    },\n\n    renderLootMessage: function(items) {\n      var enemy = GameState.currentMoment.enemy;\n      var loot = items;\n      var multipleLoots = loot.length > 0;\n      var oneLoot = loot.length === 1;\n      var defeatedEnemy;\n      var foundLoot;\n      var conj;\n      if(enemy) {\n        defeatedEnemy = ' defeated '+colorize(enemy, '#fff')+'';\n      }\n      else {\n        defeatedEnemy = '';\n      }\n      if(multipleLoots) {\n        foundLoot = ' found';\n        if(oneLoot) {\n          var item = loot[0];\n          foundLoot += ' '+colorize(item.name, UI.colors[item.rarity])+'';\n        }\n        else {\n          forEach(loot, function(item) {\n            if(loot.indexOf(item) < loot.length-1) {\n                foundLoot += ' '+colorize(item.name, UI.colors[item.rarity])+',';\n            }\n            else {\n              foundLoot += ' and '+colorize(item.name, UI.colors[item.rarity])+'';\n            }\n          });\n        }\n      }\n      else {\n        foundLoot = '';\n      }\n      if(enemy && multipleLoots) {\n        conj = ' and';\n      }\n      else {\n        conj = '';\n      }\n      this.renderCombatLog(colorize('You', UI.colors.player) + defeatedEnemy + conj + foundLoot + '.');\n    },\n  },\n\n  combat: {\n    renderHealthBar: function() {\n      var healthBar = document.createElement('div');\n      healthBar.classList.add('health-bar');\n      UI.combatLog.el.appendChild(healthBar);\n    },\n    updateHealthBar: function() {\n      var el = document.querySelector('.health-bar');\n      var pct = (Player.healthTotal/Player.healthMax).toFixed(2);\n      var adjustedPct = (100 - pct * 100);\n      el.style.background = 'linear-gradient(to bottom, #1e5799 '+(adjustedPct)+'% ,#1e5799 '+(adjustedPct)+'% ,'+colorHealth(pct)+' '+(adjustedPct)+'%)';\n    }\n  },\n\n  scrollToBottom: function(pane) {\n    pane.scrollTop = pane.scrollHeight;\n  },\n\n  reset: function() {\n    this.combatLog.el.innerHTML = '';\n    this.inventory.el.innerHTML = '';\n    UI.statlist.renderStats();\n  }\n};\n","'use strict';\n\nvar Combat = {\n  fighting: true,\n  rounds: 0,\n  generateEnemy: function() {\n    var enemyType = getObj(Enemies, GameState.currentMoment.enemy);\n    var enemy = enemyType.constructor.name === 'Enemy' ? buildNormalEnemy(enemyType.name, enemyType.level) : buildCustomEnemy(enemyType.name, enemyType.level, enemyType.healthTotal, enemyType.equippedWeapon.name, enemyType.armor, enemyType.quicknessProc);\n    enemy.healthMax = enemy.healthTotal;\n    Combat.enemy = enemy;\n  },\n  playerWins: function() {\n    Combat.fighting = false;\n    Player.pickUpLoot();\n    Player.pickUpGold();\n    Combat.awardExperience();\n    GameState.setCurrentMoment(Moments['moment' + GameState.currentMoment.link + '']);\n  },\n  playerLoses: function() {\n    Combat.fighting = false;\n    UI.combatLog.renderCombatLog(''+colorize('You', UI.colors.player)+' were slain by ' + colorize(Combat.enemy.name, '#fff') + '');\n    Player.updateStats();\n    GameState.setCurrentMoment(Moments.playerLost);\n  },\n  awardExperience: function() {\n    var exp = this.rounds + 15*Combat.enemy.level;\n    Player.updateExperience(exp);\n    var hasEnoughExp = Player.experience > Player.calcNexLevelExp();\n    if(hasEnoughExp) {\n      Player.levelUp();\n    }\n  },\n  fight: function(count) {\n    var attacker;\n    var defender;\n    var enemy = Combat.enemy;\n    if(count % 2) {\n      attacker = enemy;\n      defender = Player;\n    }\n    else {\n      attacker = Player;\n      defender = enemy;\n    }\n    if (attacker.healthTotal > 0) {\n      attacker.attack(defender);\n    } else if (attacker === enemy) {\n      Combat.playerWins();\n    }\n    else {\n      Combat.playerLoses();\n    }\n  },\n  runCombat: function() {\n    var thisCombat;\n    var count = 0;\n    Combat.generateEnemy();\n    UI.combatLog.renderCombatLog(colorize(Combat.enemy.name+' attacks!', UI.colors.red));\n    thisCombat = setInterval(function() {\n      if (Combat.fighting) {\n        count++;\n        Combat.fight(count);\n      } else {\n        clearInterval(thisCombat);\n        Combat.fighting = true;\n        Combat.rounds = count;\n      }\n    }, 700);\n  }\n};\n","'use strict';\n\nvar Effects = {\n\tbuffs: {\n\t\tstatBuff: function(amt, stats, description) {\n\t\t\tthis.amt = amt;\n\t\t\tthis.stats = stats;\n\t\t\tthis.description = description;\n\t\t},\n\t\ttoughness: function(amt) {\n\t\t\treturn new Effects.buffs.statBuff(amt, ['toughness', 'healthTotal', 'healthMax', 'armor'], 'Toughness +'+amt+'');\n\t\t},\n\t\tquickness: function(amt) {\n\t\t\treturn new Effects.buffs.statBuff(amt, ['quickness'], 'Quickness +'+amt+'');\n\t\t},\n\t\tweaponDamage: function(amt, minMax) {\n\t\t\tvar type = minMax === 'min' ? 0 : 1;\n\t\t\tvar effect = new Effects.buffs.statBuff(amt, type, 'Increase your equipped weapons\\'s '+minMax+' damage by '+amt+'');\n\t\t\teffect.run = function() {\n\t\t\t\tvar logMessage;\n\t\t\t\tif(Player.equippedWeapon) {\n\t\t\t\t\tPlayer.equippedWeapon.damage[type] += this.amt;\n\t\t\t\t\tlogMessage = 'Your '+colorize(Player.equippedWeapon.name, UI.colors[Player.equippedWeapon.rarity])+'\\'s max attack is increased by '+amt+'';\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlogMessage = 'You need to equip a weapon to use this';\n\t\t\t\t}\n\t\t\t\tUI.combatLog.renderCombatLog(logMessage);\n\t\t\t};\n\t\t\treturn effect;\n\t\t}\n\t},\n\tdebuffs: {\n\n\t},\n\theals: {\n\t\theal: function(amt) {\n\t\t\tthis.amt = amt;\n\t\t\tthis.description = 'Restore '+amt+' hp';\n\t\t\tthis.logMessage = colorize('You', UI.colors.player)+' are '+colorize('healed', UI.colors.green)+' for '+colorize(amt, UI.colors.green)+'';\n\t\t},\n\t\thealPlayer: function(amt) {\n\t\t\treturn new Effects.heals.heal(amt);\n\t\t}\n\t},\n\tquest: {\n\n\t},\n\tprocs: {\n\t\titemProc: function(amt, chance, description) {\n\t\t\tthis.amt = amt;\n\t\t\tthis.chance = chance;\n\t\t\tthis.description = description;\n\t\t},\n\t\tweaponDamage: function(amt, chance) {\n\t\t\tvar wd = new Effects.procs.itemProc(amt, chance, chance + '% chance to deal '+amt+' damage');\n\t\t\twd.run = function() {\n\t\t\t\tvar procChance = roll(0,100);\n\t\t\t\tif(procChance <= chance) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn wd;\n\t\t},\n\t\tmirrorDamage: function(amt, chance) {\n\t\t\tvar e = new Effects.procs.itemProc(amt, chance, chance + '% chance to reflect damage');\n\t\t\te.run = function() {\n\t\t\t\tvar procChance = roll(0,100);\n\t\t\t\tif(procChance <= chance) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn e;\n\t\t}\n\t}\n};\n\nEffects.buffs.statBuff.prototype.run = function() {\n\tvar amount = this.amt;\n\tforEach(this.stats, function(stat) {\n\t\tPlayer[stat] += amount;\n\t});\n};\n\nEffects.buffs.statBuff.prototype.remove = function() {\n\tfor(var i = 0; i < this.stats.length; i++) {\n\t\tPlayer[this.stats[i]] -= this.amt;\n\t}\n};\n\nEffects.heals.heal.prototype.run = function() {\n\tvar lostHealth = Player.healthMax - Player.healthTotal;\n\tif(this.amt <= lostHealth) {\n\t\tPlayer.healthTotal += this.amt;\n\t}\n\telse {\n\t\tPlayer.healthTotal += lostHealth;\n\t}\n\tUI.combatLog.renderCombatLog(this.logMessage);\n};\n\nvar QuestEffect = function(description, content) {\n\tthis.description = description;\n\tthis.content = content;\n};\n\nQuestEffect.prototype.run = function() {\n\tUI.combatLog.renderCombatLog(this.content);\n};\n","'use strict';\n\nvar Items = {\n\tweapons: [],\n\tarmor: [],\n\tconsumables: [],\n\tall: []\n};\n\nvar Pricing = {\n\trarities: {\n\t\t'none': 0.5,\n\t\t'common': 1,\n\t\t'rare': 1.5,\n\t\t'epic': 2,\n\t\t'legendary': 3,\n\t\t'set': 3\n\t},\n\ttypes: {\n\t\t'weapon': 1,\n\t\t'armor': 0.6,\n\t\t'consumable': 0.3\n\t}\n};\n\nvar Item = function(name, level, rarity, flavorText) {\n\tthis.name = name;\n\tthis.level = level;\n\tthis.rarity = rarity;\n\tthis.flavorText = flavorText;\n};\n\nItem.prototype.use = function() {\n\tif(this.hasOwnProperty('effect')) {\n\t\tfor(var i = 0; i < this.effect.length; i++) {\n\t\t\t\tthis.effect[i].run();\n\t\t}\n\t\tPlayer.updateStats();\n\t}\n};\n\nItem.prototype.desc = function() {\n\treturn this.effect.desc();\n};\n\nItem.prototype.getRarityMultiplier = function() {\n\treturn Pricing.rarities[this.rarity] * Pricing.types[this.itemType];\n};\n\nItem.prototype.getSalePrice = function() {\n\treturn ((this.level*10) * this.getRarityMultiplier().toFixed(1));\n};\n\nItem.prototype.getPurchasePrice = function() {\n\treturn (this.level*10) * this.getRarityMultiplier() + (this.level*5);\n};\n\nvar Weapon = function(name, level, rarity, flavorText, damage, effects){\n\tvar weapon = new Item(name,level, rarity, flavorText);\n\tweapon.damage = damage;\n\tweapon.itemType = 'weapon';\n\tif(effects) {\n\t\tweapon.effect = effects;\n\t}\n\treturn weapon;\n};\n\nvar Armor = function(name, level, rarity, flavorText, slot, armorAmt, effects) {\n\tvar armor = new Item(name,level, rarity, flavorText);\n\tarmor.slot = slot;\n\tarmor.armorAmt = armorAmt;\n\tarmor.itemType = 'armor';\n\tif(effects) {\n\t\tarmor.effect = effects;\n\t}\n\treturn armor;\n};\n\nvar Consumable = function(name, level, rarity, flavorText, effects){\n\tvar consumable = new Item(name,level, rarity, flavorText);\n\tconsumable.effect = effects;\n\tconsumable.itemType = 'consumable';\n\treturn consumable;\n};\n\nvar buildItems = function() {\n\tforEach(items, function(enemy){\n\t\tEnemies.push(new Enemy(enemy[0], enemy[1]));\n\t});\n};\n\nItems.weapons.push(\n\tnew Weapon('Foam Sword', 0, 'none', 'Just for fun', [0,0]),\n\n\tnew Weapon('Muddy Hatchet', 1, 'none', '', [1, 3]),\n\tnew Weapon('Rusty Short Sword', 1, 'none', '', [2, 4]),\n\tnew Weapon('Dull Axe', 1, 'none', '', [1, 5]),\n\tnew Weapon('Wooden Staff', 1, 'none', '', [2, 3]),\n\tnew Weapon('Bent Spear', 1, 'none', '', [1, 4]),\n\tnew Weapon('Iron Dagger', 1, 'common', '', [3, 4]),\n\tnew Weapon('Short Spear', 1, 'common', '', [1, 6]),\n\tnew Weapon('Blacksmith Hammer', 1, 'common', '', [2, 5]),\n\tnew Weapon('Bronze Short Sword', 1, 'common', '', [3, 4]),\n\n\tnew Weapon('Rusty Battle Axe', 2, 'none', '', [1, 6]),\n\tnew Weapon('Oak Club', 2, 'none', '', [2, 5]),\n\tnew Weapon('Old Longsword', 2, 'none', '', [3, 4]),\n\tnew Weapon('Logging Axe', 2, 'none', '', [2, 6]),\n\tnew Weapon('Bronze Spear', 2, 'common', '', [1, 8]),\n\tnew Weapon('Balanced Dagger', 2, 'rare', '', [3, 5], [Effects.buffs.quickness(1)]),\n\tnew Weapon('Fang Claws', 2, 'common', '', [2, 7]),\n\tnew Weapon('Iron Short Sword', 2, 'common', '', [3, 6]),\n\n\tnew Weapon('Wind Blade', 3, 'rare', '', [4, 9], [Effects.procs.weaponDamage(2, 15)]),\n\tnew Weapon('Double Edged Katana', 10, 'epic', '', [5, 7], [Effects.procs.weaponDamage(5, 10)]),\n\tnew Weapon('Sadams Golden AK-47', 20, 'legendary', 'Complete with incendiary rounds', [77, 133], [Effects.procs.weaponDamage(33, 20)]),\n\tnew Weapon('P-70 Stealthhawk', 8, 'epic', '', [17, 25], [Effects.buffs.quickness(8)]),\n\tnew Weapon('Heartsbane', 10, 'legendary', 'A real heartbreaker', [7, 13], [Effects.buffs.quickness(7), Effects.procs.weaponDamage(100, 5)]),\n\tnew Weapon('Kusanagi the Grass Cutter', 30, 'set', 'Previously known as Sword of the Gathering Clouds of Heaven', [123, 244], [Effects.buffs.toughness(20), Effects.buffs.quickness(35), Effects.procs.weaponDamage(50, 15)])\n);\n\nItems.armor.push(\n\tnew Armor('Wool Shirt', 1, 'none', '', 'chest', 2),\n\tnew Armor('Twine Cinch', 1, 'none', '','belt', 1),\n\tnew Armor('Ragged Trousers', 1, 'none', '','pants', 1),\n\tnew Armor('Damp Boots', 1, 'none', '','boots', 1),\n\tnew Armor('Linen Shirt', 1, 'rare', '','chest', 2, [Effects.buffs.quickness(1)]),\n\tnew Armor('Leather Belt', 1, 'common', '','belt', 2),\n\tnew Armor('Wool Cap', 1, 'common', '','head', 2),\n\tnew Armor('Old Cloak', 1, 'common', '','back', 2),\n\tnew Armor('Leather Sandals', 1, 'none', '','boots', 2),\n\n\tnew Armor('Wool Sash', 2, 'none', '','belt', 2),\n\tnew Armor('Old Canvas Pants', 2, 'none', '','pants', 2),\n\tnew Armor('Skull Cap', 2, 'none', '','head', 2),\n\tnew Armor('Thick Wool Shirt', 2, 'common', '','chest', 4),\n\tnew Armor('Thick Leather Belt', 2, 'common', '','belt', 3),\n\tnew Armor('Leather Hat', 2, 'common', '','head', 3),\n\tnew Armor('Wool Cloak', 2, 'common', '','back', 3),\n\tnew Armor('Travelers Boots', 2, 'common', '','boots', 3),\n\n\tnew Armor('Centurian Cask', 8, 'epic', '','head', 18, [Effects.buffs.toughness(6), Effects.buffs.quickness(6)]),\n\tnew Armor('Yata no Kagami', 30, 'set', '','back', 90, [Effects.buffs.toughness(40), Effects.procs.mirrorDamage(2, 20)]),\n\tnew Armor('Arturus Tabard', 10, 'legendary', 'This belonged to a true badass.','chest', 50, [Effects.buffs.toughness(10), Effects.buffs.quickness(10)])\n);\n\nItems.consumables.push(\n\tnew Consumable('Chicken Egg', 1, 'none', '', [Effects.heals.healPlayer(4)]),\n\tnew Consumable('Peasant Bread', 1, 'none', '', [Effects.heals.healPlayer(5)]),\n\tnew Consumable('Jerky', 1, 'common', '', [Effects.heals.healPlayer(6)]),\n\tnew Consumable('Dried Trout', 2, 'none', '', [Effects.heals.healPlayer(8)]),\n\tnew Consumable('Sharpsword Oil', 2, 'rare', '', [Effects.buffs.weaponDamage(2, 'max')]),\n\tnew Consumable('Whetstone', 2, 'common', '', [Effects.buffs.weaponDamage(1, 'min')])\n);\n\nvar QuestItem = function(name, rarity, flavorText, effects) {\n\tthis.name = name;\n\tthis.itemType = 'quest';\n\tthis.rarity = rarity;\n\tthis.flavorText = flavorText;\n\tthis.use = Item.prototype.use;\n\tthis.effect = effects;\n};\n\nItems.all = Items.weapons.concat(Items.armor, Items.consumables);\n\nItems.all.push(new QuestItem('Message', 'epic', 'The cover says: \"To be delivered to Jawn Peteron\"', [new QuestEffect('Click to read', 'It reads \"There used to be a graying tower alone on the sea.\" That\\'s the opening lyric to Seal\\'s \"Kiss from a Rose.\" Curious.')]));\n\n// var weaponTypes = ['Sword', 'Shortsword', 'Longsword', 'Bastardsword', 'Rapier', 'Katana', 'Dirk', 'Gladius', 'Broadsword', 'Fencer', 'Claymore', 'Scimitar', 'Cutlass'];\n// var weaponDescriptors = ['Double Edged', 'Damascus', 'Steel', 'Iron', 'Folded', 'Cobalt', 'Fine', 'Serrated', 'Sharp', 'Heavy', 'Weighted', 'Ancient', 'Bloody', 'Blinding'];\n\n// var newSword = function() {\n// \tvar type = weaponTypes[roll(0,weaponTypes.length)];\n// \tvar kind = weaponDescriptors[roll(0,weaponDescriptors.length)];\n// \tvar minDamage = roll(0,100);\n// \tvar maxDamage = minDamage + roll(0, minDamage);\n// \treturn new Weapon(''+kind+' '+type+'', 4, 'common', '', minDamage, maxDamage);\n// };\n","'use strict';\n\nvar Enemies = [];\n\nvar Enemy = function(name, level) {\n\tthis.name = name;\n\tthis.level = level;\n\tthis.healthTotal = 10 + ((level - 1) * 4 + 1);\n\tthis.armor = ((level - 1) * 4 + 1);\n\tthis.quicknessProc = 5;\n\tthis.equippedWeapon = getRandomLootByLevel('weapons', level);\n\tthis.damageReduction  = (1 - (0.03*this.armor)/(1 + 0.03*this.armor)).toFixed(2);\n};\n\nvar CustomEnemy = function(name, level, healthTotal, weapon, armor, quicknessProc) {\n\tthis.name = name;\n\tthis.level = level;\n\tthis.healthTotal = healthTotal;\n\tthis.armor = armor;\n\tthis.quicknessProc = quicknessProc;\n\tthis.equippedWeapon = getObj(Items.weapons, weapon);\n\tthis.damageReduction  = (1 - (0.03*this.armor)/(1 + 0.03*this.armor)).toFixed(2);\n};\n\nEnemy.prototype.getBaseDamage = function() {\n\treturn this.equippedWeapon ? roll(this.equippedWeapon.damage[0],this.equippedWeapon.damage[1]) : roll(0,3);\n};\nCustomEnemy.prototype.getBaseDamage = function() {\n\treturn this.equippedWeapon ? roll(this.equippedWeapon.damage[0],this.equippedWeapon.damage[1]) : roll(0,3);\n};\n\nEnemy.prototype.attack = function(target) {\n\tPlayer.attack.call(this, target);\n};\nCustomEnemy.prototype.attack = function(target) {\n\tPlayer.attack.call(this, target);\n};\n\nEnemy.prototype.rollQuicknessProc = function() {\n\treturn roll(0, 100) <= this.quicknessProc ? true : false;\n};\nCustomEnemy.prototype.rollQuicknessProc = function() {\n\treturn roll(0, 100) <= this.quicknessProc ? true : false;\n};\n\nvar enemies = [\n\t['Vagrant Ranger', 1],\n\t['Gray Wolf', 1],\n\t['Derranged Lunatic', 1],\n\t['Highway Bandit', 1],\n\t['Wandering Looter', 1],\n\t['Cloaked Assassin', 1],\n\t['Town Guard', 2],\n\t['Black Wolf', 2],\n];\n\nvar customEnemies = [\n\t['Sinclair Graves', 4, 40, 'Wind Blade', 10, 5],\n\t['Target Dummy', 2, 1000, 'Foam Sword', 1, 0],\n\t['Volkswain the Unmarred', 10, 400, 'Wind Blade', 20, 15]\n];\n\nvar buildNormalEnemy = function(name, level){\n\treturn new Enemy(name, level);\n};\nvar buildCustomEnemy = function(name, level, healthTotal, weapon, armor, quicknessProc){\n\treturn new CustomEnemy(name, level, healthTotal, weapon, armor, quicknessProc);\n};\n\nvar buildEnemies = function() {\n\tvar allEnemies = enemies.concat(customEnemies);\n\tforEach(allEnemies, function(enemy) {\n\t\tif(enemy.length > 2) {\n\t\t\tEnemies.push(buildCustomEnemy.apply(null, enemy));\n\t\t}\n\t\telse {\n\t\t\tEnemies.push(buildNormalEnemy.apply(null, enemy));\n\t\t}\n\t});\n};\n\nbuildEnemies();\n\n// Enemies.push(new Enemy('Vagrant Ranger', 1));\n// Enemies.push(new Enemy('Derranged Lunatic', 1));\n// Enemies.push(new Enemy('Highway Bandit', 1));\n// Enemies.push(new Enemy('Wandering Looter', 1));\n// Enemies.push(new Enemy('Goblin Trapper', 1));\n// Enemies.push(new Enemy('Cloaked Assassin', 1));\n//\n// Enemies.push(new Enemy('Town Guard', 2));\n// Enemies.push(new Enemy('Black Wolf', 2));\n//\n// Enemies.push(new CustomEnemy('Sinclair Graves', 4, 40, 'Wind Blade', 10, 5));\n// Enemies.push(new CustomEnemy('Target Dummy', 2, 1000, 'Foam Sword', 1, 0));\n// Enemies.push(new CustomEnemy('Volkswain the Unmarred', 10, 400, 'Heartsbane', 20, 15));\n","'use strict';\n\nvar Moments = {\n\tmoment0: {\n\t\tmessage: 'You\\'re dreaming you\\'re in a small boat. The black water around you stirs.',\n\t\tchoices: [{message: 'Wake up', link: 1}],\n\t\tonLoad: function() {\n\t\t\tPlayer.reset();\n\t\t\tUI.reset();\n\t\t}\n\t},\n\tmoment1: {\n\t\tmessage: 'You are suddenly conscious, and remember nothing.',\n\t\tchoices: [{message: 'Blink',link: 2}],\n\t\t// dropLoot: ['Kusanagi the Grass Cutter', 'Centurian Cask', 'Double Edged Katana', 'Arturus Tabard', 'Thick Wool Shirt', 'Sharpsword Oil']\n\t},\n\tmoment2: {\n\t\tmessage: 'You are standing in a dark woods.',\n\t\tchoices: [{message: 'Check your belongings',link: 4},{message: 'Look around',link: 3}]\n\t},\n\tmoment3: {\n\t\tmessage: 'The sun has just set. You are surrounded by trees bathed in twilight.',\n\t\tchoices: [{message: 'Check your belongings',link: 4}]\n\t},\n\tmoment4: {\n\t\tmessage: 'Looped to your belt you find a weapon.',\n\t\tchoices: [{message: 'Start Walking',link: 5}],\n\t\tdropLoot: [['weapons', 1]],\n\t\tonLoad: function() {\n\t\t\tequipping.init();\n\t\t},\n\t},\n\tmoment5: {\n\t\tmessage: 'You walk until you see a glowing light spidering through the trees.',\n\t\tchoices: [{message: 'Take a closer look',link: 6}]\n\t},\n\tmoment6: {\n\t\tmessage: 'From behind a tree you see a hunter stoking a fire. With him is a man tied up, slumped at the base of a tree.',\n\t\tchoices: [{message: '\"Where am I\"?',link: 8}]\n\t},\n\tmoment8: {\n\t\tmessage: '\"Somewhere you shouldn\\'t be.\"',\n\t\tenemy: 'Vagrant Ranger',\n\t\t// enemy: 'Target Dummy',\n\t\t// enemy: 'Volkswain the Unmarred',\n\t\tdropLoot: [['armor', 1], 'Chicken Egg'],\n\t\tlink: 10\n\t},\n\tmoment9: {\n\t\tmessage: 'You find a road and begin walking west. Up ahead you see a figure on horseback galloping towards you.',\n\t\tchoices: [{message: 'Keep walking',link: 14},{message: 'Hide',link: 15}]\n\t},\n\tmoment10: {\n\t\tmessage: 'After taking a minute to recover, you turn to the captured man.',\n\t\tchoices: [{message: '\"Are you alright?\"',link: 12},{message: 'Take a closer look',link: 12}],\n\t\tonLoad: function() {\n\t\t\thealing.init();\n\t\t},\n\t},\n\tmoment12: {\n\t\tmessage: 'As you lean in to check if the man is alive, he suddenly lunges at you.',\n\t\tenemy: 'Derranged Lunatic',\n\t\tdropLoot: [['armor', 1], 'Message'],\n\t\tlink: 13\n\t},\n\tmoment13: {\n\t\tmessage: 'You notice a lockbox on the ground near the fire.',\n\t\tchoices: [{message: 'Check it out',link: '13a'}, {message: 'Continue on',link: 9}],\n\t},\n\tmoment13a: {\n\t\tmessage: 'There\\'s nothing else here.',\n\t\tchoices: [{message: 'Continue on',link: 9}],\n\t\tdropLoot: [['all', 1], ['consumables', 1]]\n\t},\n\tmoment14: {\n\t\tmessage: 'As the man gets closer, he draws a sword.',\n\t\tchoices: [{message: 'Fight',link: 16},{message: 'Hide',link: 15}]\n\t},\n\tmoment15: {\n\t\tmessage: 'You run into the trees until you cannot see the road. You hear the figure pass. Ahead of you is a ruined mill.',\n\t\tchoices: [{message: 'Check out the mill',link: 17},{message: 'Go back to the road',link: 18}]\n\t},\n\tmoment16: {\n\t\tmessage: 'You draw your weapon and stand your ground.',\n\t\tenemy: 'Highway Bandit',\n\t\tdropLoot: [['all', 1]],\n\t\tlink: 18\n\t},\n\tmoment17: {\n\t\tmessage: 'You approach the shoddy old mill until you can hear voices coming from inside.',\n\t\tchoices: [{message: 'Take a peek',link: '17b'},{message: 'Bust in there',link: '17b'},{message: 'Go back to the road',link: 18}]\n\t},\n\tmoment17b: {\n\t\tmessage: '\"Who the fuck are you?\" says Sinclair Black, a notable thief.',\n\t\tchoices: [{message: '\"Your mom\"',link: '17c'},{message: 'Punch him in the face',link: '17c'},{message: 'Run away',link: 18}]\n\t},\n\tmoment17c: {\n\t\tmessage: '\"You bitch, I will end you.\"',\n\t\tenemy: 'Sinclair Graves',\n\t\tdropLoot: ['Wind Blade', 'Jerky'],\n\t\tlink: 18\n\t},\n\tmoment18: {\n\t\tmessage: 'You walk for miles until you see a steeple poking up from the treeline ahead. It seems you found a town.',\n\t\tchoices: [{message: 'Look around',link: 19},{message: 'Talk to someone',link: 20}]\n\t},\n\tmoment19: {\n\t\tmessage: 'You walk to the town square and look around. Where would you like to go?',\n\t\tchoices: [{message: 'The Arms Shop',link: 20},{message: 'The General Store',link: 21}, {message: 'The Inn',link: 22}, {message: 'The Town Hall',link: 24}]\n\t},\n\tmoment20: {\n\t\tmessage: 'You enter the arms shop. \"Ahoy there traveler,\" says the owner. \"What can I do for you?\"',\n\t\tshop: [['weapons', 1], ['weapons', 1], ['weapons', 2], ['armor', 1], ['armor', 2]],\n\t\tchoices: [{message: 'Leave the shop', link: 19}]\n\t},\n\tmoment21: {\n\t\tmessage: 'You enter the general store. \"Hey baby,\" says the clerk. \"What can I help you with?\"',\n\t\tshop: [['consumables', 1], ['consumables', 1], ['consumables', 2], ['consumables', 2]],\n\t\tchoices: [{message: 'Leave the shop', link: 19}]\n\t},\n\tmoment22: {\n\t\tmessage: 'You enter the inn. \"Sup playa,\" says the innkeeper. \"Would you like a room? Its 2 gold for the night.\"',\n\t\tchoices: [{message: 'Yes please', link: 23}, {message: 'No thanks', link: 19}]\n\t},\n\tmoment23: {\n\t\tmessage: 'You go up to your room and sleep off your wounds. You wake up feeling like a million bucks.',\n\t\tinn: 2,\n\t\tchoices: [{message: 'Leave the inn', link: 19}, {message: 'Get another room', link: 23}]\n\t},\n\tmoment24: {\n\t\tmessage: 'You stand in the large chamber of the Town Hall. Merchants and town leaders are assembled in discussion.',\n\t\tchoices: [{message: 'Leave the hall', link: 19}, {message: 'Look around', link: 26}, {message: 'Ask for Jawn Peterson', link: 26}, {message: 'Talk to the tenant-in-chief', link: 27}]\n\t},\n\tmoment26: {\n\t\tmessage: 'You approach a man writing at a desk near the entrance. \"Do you know a man who goes by Jawn Peterson?\" you ask. \"The man points to two men standing near a side entrance.\"',\n\t\tchoices: [{message: 'Go over', link: 27}, {message: 'Do something else', link: 24}]\n\t},\n\tmoment27: {\n\t\tmessage: 'The men spot you approaching. \"Are you Jawn Peterson? you ask.\" He seems to look you over until replying \"Yes I am. Would you like to join me for a drink? You look like you could use it.\"',\n\t\tchoices: [{message: 'Go with him', link: 28}, {message: 'Do something else', link: 24}]\n\t},\n\tmoment28: {\n\t\tmessage: 'You walk outside and turn the corner. The cloaked man with Jawn Peterson suddenly pulls a dagger on you and attacks.',\n\t\tenemy: 'Cloaked Assassin',\n\t\tdropLoot: [['all', 2]],\n\t\tlink: 24\n\t},\n\tplayerLost: {\n\t\tmessage: 'You were killed. Sorry.',\n\t\tchoices: [{message: 'Start over',link: 0}]\n\t}\n};\n","'use strict';\n\nPlayer.updateStats();\nPlayer.updateGold(0);\nUI.itemDescription.bindStatEvents();\n\nvar equipping = new Acquaint('equipping', [\n  {\n    title: 'Equipping items',\n    message: function(){return 'You found a weapon! When equipped, weapons and armor apply their stats to your character. Click on that '+Player.inventory[0].name+' now to equip.';},\n    target: '.inventory-list li',\n    position: 'bottom-left',\n    advance: {\n      element: '.inventory-list li',\n      event: 'onclick'\n    }\n  },\n  {\n    title: 'Understanding stats',\n    message: 'These are your stats. Increasing them with items and leveling up makes you more powerful. Hover over them to see what they do.',\n    target: '[data-stat=\"damage\"]',\n    position: 'bottom-left',\n    button: 'Got it'\n  }\n]);\n\nvar healing = new Acquaint('healing', [\n  {\n    title: 'Combat',\n    message: 'Well done. In combat, you exchange damage with an enemy until one of your health reaches 0. Victory rewards you with loot, gold, and experience points. Die, and you start over.',\n    target: window,\n    position: 'top-right',\n    button: 'Got it',\n  },\n  {\n    title: 'Healing yourself',\n    message: 'You\\'ll usually get injured in combat. Some items, like this egg, restore health points. Heals can be used anytime, even while fighting. Try using it now.',\n    target: '[data-item=\"Chicken Egg\"]',\n    position: 'bottom-left',\n    advance: {\n      element: '[data-item=\"Chicken Egg\"]',\n      event: 'onclick'\n    }\n  }\n]);\n"]}
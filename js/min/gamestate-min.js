"use strict";var GameState={currentMoment:"",setCurrentMoment:function(e){this.currentMoment=e,UI.narrative.renderMoment(),this.checkForAndCreateChoices(),this.checkForAndPickUpLoot(),this.checkForAndRunCombat(),this.checkForAndOpenUpShop(),this.checkForAndRunInn(),this.checkForAndRunOnLoad(),UI.scrollToBottom(UI.narrative.el)},checkForAndRunOnLoad:function(){this.currentMoment.hasOwnProperty("onLoad")&&this.currentMoment.onLoad()},processRandomLoot:function(e){var o;return o="object"==typeof e?getRandomLootByLevel(e[0],e[1]):getObj(Items.all,e)},checkForAndPickUpLoot:function(){var e=this.currentMoment.hasOwnProperty("dropLoot")&&!this.currentMoment.hasOwnProperty("enemy");e&&Player.pickUpLoot()},checkForAndRunCombat:function(){this.currentMoment.hasOwnProperty("enemy")&&Combat.runCombat()},checkForAndOpenUpShop:function(){this.currentMoment.hasOwnProperty("shop")?(UI.narrative.renderShop(),this.bindShopItemEvents()):this.bindWorldItemEvents()},checkForAndRunInn:function(){var e=this.currentMoment.hasOwnProperty("inn");if(e){var o=this.currentMoment.inn;Player.gold>=o?(Player.updateGold(-o),Player.healthTotal=Player.healthMax,Player.updateStats(),UI.combatLog.renderCombatLog(colorize("You",UI.colors.player)+" bought a room for "+colorize(o+" gold",UI.colors.gold)+"."),UI.combatLog.renderCombatLog(colorize("Your",UI.colors.player)+" health is "+colorize("fully restored","#24fb27"))):UI.combatLog.renderCombatLog(colorize("You",UI.colors.player)+" need "+colorize(o-Player.gold,UI.colors.gold)+" to get a room.")}},checkForAndCreateChoices:function(){var e=this.currentMoment.hasOwnProperty("choices");e&&UI.narrative.renderChoices()},bindWorldItemEvents:function(){for(var e=UI.inventory.el.querySelectorAll("[data-item]"),o=0;o<e.length;o++)e[o].onclick=UI.inventory.activateItem},bindShopItemEvents:function(){for(var e=UI.narrative.el.querySelectorAll("[data-item]"),o=UI.inventory.el.querySelectorAll("[data-item]"),t=0;t<e.length;t++)e[t].onclick=Player.purchaseItem;for(var r=0;r<o.length;r++)o[r].onclick=Player.sellItem},messages:{gainLvl:colorize("You gained a level! Your toughness and quickness have increased by 1.","yellow")},reset:function(){GameState=new GameState,GameState.setCurrentMoment(Moments.moment1)}};